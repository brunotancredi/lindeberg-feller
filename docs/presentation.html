<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lindeberg-Lévy-Feller Theorem</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a14e3238c51140e99ccc48519b6ed9ce.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lindeberg-Lévy-Feller Theorem</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div style="
  display:flex;
  justify-content:center;
  align-items:flex-start;
  gap:12px;
  flex-wrap:nowrap;
">
<p><img src="Lindeberg.jpg" style="width:200px;height:300px;object-fit:cover;border-radius:4px;"> <img src="levy.jpg" style="width:200px;height:300px;object-fit:cover;border-radius:4px;"> <img src="Feller.jpeg" style="width:200px;height:300px;object-fit:cover;border-radius:4px;"></p>
</div>
<p>Here, I’m going to present generalizations of the Central Limit Theorem, such as the Lindeberg–Levy–Feller Central Limit Theorem and Lyapunov’s Central Limit Theorem. The applications of the asymptotic behavior of the sample mean of random variables extend across all areas of statistics, being used for inference, hypothesis testing, estimation theory, among many others.</p>
<p>The reference material has been drawn from the books Probability: A Graduate Course <span class="citation" data-cites="gut2013probability">(<a href="#ref-gut2013probability" role="doc-biblioref">Gut, 2013</a>)</span> and Asymptotic Statistics <span class="citation" data-cites="Vaart_1998">(<a href="#ref-Vaart_1998" role="doc-biblioref">Vaart, 1998</a>)</span>, from the Large Sample Theory lectures by Prof.&nbsp;Jessica Li available on YouTube <span class="citation" data-cites="li_large_sample_theory_2020">(<a href="#ref-li_large_sample_theory_2020" role="doc-biblioref">Li, 2020</a>)</span>, and from the lecture notes by Prof.&nbsp;Marco Scavino for the Probabilidad II course at the Universidad de la República.</p>
<section id="central-limit-theorem" class="level2">
<h2 class="anchored" data-anchor-id="central-limit-theorem">Central Limit Theorem</h2>
<p>Probably we are familiar with the Central Limit Theorem (<a href="#thm-clt" class="quarto-xref">Theorem&nbsp;1</a>).</p>
<div id="thm-clt" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Central Limit Theorem)</strong></span> Let <span class="math inline">\(\{X_n\}_{n \geq  1}\)</span> be a sequence of <strong>independent</strong> and <strong>identical distributed</strong> random variables with finite expectation <span class="math inline">\(\mu\)</span> and and positive, finite variance <span class="math inline">\(\sigma^2\)</span>, and set <span class="math inline">\(S_n = X_1 + X_2 + \dots + X_n, n \geq 1\)</span>. Then</p>
<p><span id="eq-CLT"><span class="math display">\[
\frac{S_n - n\mu}{\sigma\sqrt{n}} \, \overset{d}{\rightarrow} \, \mathcal{N}(0,1), \quad \text{as} \quad n \rightarrow \infty
\tag{1}\]</span></span></p>
</div>
<section id="simulating-the-clt" class="level3">
<h3 class="anchored" data-anchor-id="simulating-the-clt">Simulating the CLT</h3>
<div class="cell panel-input card bg-light p-2" width="100%">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="48" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 47;"><span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { aq<span class="op">,</span> op } <span class="im">from</span> <span class="st">'@uwdata/arquero'</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>my_data <span class="op">=</span> aq<span class="op">.</span><span class="fu">loadCSV</span>(<span class="st">"https://raw.githubusercontent.com/brunotancredi/lindeberg-feller/refs/heads/main/CLT_simulation_data.csv"</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>viewof n <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span><span class="op">,</span> <span class="dv">400</span>]<span class="op">,</span> </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Sample Size:"</span>}</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>viewof distribution <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">"Uniform"</span><span class="op">,</span> <span class="st">"Exponential"</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="st">"Uniform"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Distribution"</span>})</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>normalData <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({ <span class="dt">length</span><span class="op">:</span> <span class="dv">100</span> }<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> x <span class="op">=</span> <span class="op">-</span><span class="dv">3</span> <span class="op">+</span> (i <span class="op">/</span> <span class="dv">99</span>) <span class="op">*</span> <span class="dv">6</span><span class="op">;</span> <span class="co">// Range from -3 to 3</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> { x<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> x <span class="op">*</span> x) <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) }<span class="op">;</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>my_data_2 <span class="op">=</span> my_data<span class="op">.</span><span class="fu">params</span>({ distribution })<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">distribution</span> <span class="op">===</span> distribution)<span class="op">;</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>point <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">1</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> {<span class="cf">return</span> {<span class="dt">x</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fl">0.5</span>}})</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {<span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {<span class="dt">round</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span>    </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">rectY</span>(my_data_2<span class="op">,</span> </span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>                Plot<span class="op">.</span><span class="fu">binX</span>({<span class="dt">y</span><span class="op">:</span> (a<span class="op">,</span> bin) <span class="kw">=&gt;</span> {</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>                              <span class="cf">return</span> a<span class="op">.</span><span class="at">length</span> <span class="op">/</span> (<span class="dv">5000</span><span class="op">*</span>(bin<span class="op">.</span><span class="at">x2</span> <span class="op">-</span> bin<span class="op">.</span><span class="at">x1</span>))<span class="op">;</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>                           }}<span class="op">,</span> </span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>                          {<span class="dt">x</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> n<span class="op">.</span><span class="fu">toString</span>()<span class="op">,</span> </span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>                               <span class="dt">inset</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>                               <span class="dt">thresholds</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="dv">3</span><span class="op">,</span><span class="dv">3</span> <span class="op">+</span> <span class="fl">0.11</span><span class="op">,</span> <span class="fl">0.11</span>)<span class="op">,</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>                               <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span><span class="dv">3</span><span class="op">,</span> <span class="dv">3</span>]<span class="op">,</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>                               }}))<span class="op">,</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">line</span>(normalData<span class="op">,</span> { <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span> })<span class="op">,</span> <span class="co">//Normal</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>(point<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">r</span><span class="op">:</span> <span class="dv">0</span>})    </span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-8" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p>The problem with the theorem is that requires a two strong assumptions <strong>idependency</strong> and <strong>identical distribution</strong>, what if I told you that we can relax one of the conditions?</p>
</section>
</section>
<section id="lindeberg-lévy-feller" class="level2">
<h2 class="anchored" data-anchor-id="lindeberg-lévy-feller">Lindeberg-Lévy-Feller</h2>
<p>Let <span class="math inline">\(\{X_n\}_{n \geq 1}\)</span> be a sequence of <strong>independent</strong> random variables with finite variances, and set, for <span class="math inline">\(k \geq 1, \mathbb{E}[X_k]= \mu_k, Var[X_k] = \sigma_k^2\)</span> and for <span class="math inline">\(n \geq 1, S_n = \sum^{n}_{k=1}X_k\)</span> and <span class="math inline">\(V_n^2 = \sum^n_{k=1}\sigma_k^2\)</span></p>
<section id="conditions" class="level3">
<h3 class="anchored" data-anchor-id="conditions">Conditions</h3>
<p><span id="eq-Lind1"><span class="math display">\[
L_1(n) = \frac{1}{V_n^2}\sum^{n}_{k=1}\mathbb{E}\big[(X_k - \mu_k)^2\mathbf{1}_{\{|X_k - \mu_k| \gt \epsilon V_n\}}\big] \underset{n \rightarrow \infty}{\rightarrow} 0, \quad \forall \epsilon \gt 0
\tag{2}\]</span></span></p>
<p><span id="eq-Lind2"><span class="math display">\[
L_2(n) = \max_{1 \leq k \leq n} \frac{\sigma^2_k}{V_n} \underset{n \rightarrow \infty}{\rightarrow} 0,
\tag{3}\]</span></span></p>
</section>
<section id="interpretating-the-conditions" class="level3">
<h3 class="anchored" data-anchor-id="interpretating-the-conditions">Interpretating the conditions</h3>
<p><span class="math inline">\(L_1\)</span> (Lindeberg’s Condition): This condition requires that the proportion of variance represented by values far from the mean is negligible. In other words, what it asks us is that the original distributions of <span class="math inline">\(X_k\)</span> do not have heavy tails.</p>
<div id="fig-sketch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sketch.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Rudimentary visualization of Lindeberg Condition
</figcaption>
</figure>
</div>
<p><span class="math inline">\(L_2\)</span>: To understand condition <span class="math inline">\(L_2\)</span>, it is useful to consider when it fails. The condition is violated when <span class="math inline">\(\sigma_k^2\)</span> represents a non-negligible portion of the total sum of variances. In other words, this occurs when the variance of a single term contributes significantly to the total variance. For example, this could happen when <span class="math inline">\(\sigma^2_k = \sum_{i=1}^{k-1} \sigma_i^2\)</span>. So we are asking o each <span class="math inline">\(X_k\)</span> to have a limited variance.</p>
</section>
<section id="theorem" class="level3">
<h3 class="anchored" data-anchor-id="theorem">Theorem</h3>
<p>Using the conditions defined above we can state the theorem as follows</p>
<div id="thm-llf" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Lindeberg-Lévy-Feller Theorem)</strong></span> <br></p>
<p>(i). If <span class="math inline">\(L_1\)</span> (<a href="#eq-Lind1" class="quarto-xref">Equation&nbsp;2</a>) is satisfied , then so is <span class="math inline">\(L_2\)</span> (<a href="#eq-Lind2" class="quarto-xref">Equation&nbsp;3</a>) and</p>
<p><span id="eq-LindCLT"><span class="math display">\[
\frac{1}{V_n}\sum^{n}_{k=1}(X_k - \mu_k) \overset{d}{\rightarrow} \mathcal{N}(0, 1), \quad \text{as} \quad n \rightarrow \infty
\tag{4}\]</span></span></p>
<p>(ii). If <a href="#eq-Lind2" class="quarto-xref">Equation&nbsp;3</a> and <a href="#eq-LindCLT" class="quarto-xref">Equation&nbsp;4</a> are satisfied, then so is <a href="#eq-Lind1" class="quarto-xref">Equation&nbsp;2</a></p>
</div>
<p>As we can see, we no longer require that the sequence be <strong>identically distributed</strong> to obtain a normal distribution. We are only requiring (i) that <span class="math inline">\(L_1\)</span> is satisfied.</p>
</section>
</section>
<section id="what-do-we-need-to-prove-it" class="level2">
<h2 class="anchored" data-anchor-id="what-do-we-need-to-prove-it">What do we need to prove it?</h2>
<p>The proof of the theorem is extensive, so here I’m going to present a sketch of the proof.</p>
<p>First, for simplicity and without loss of generality, we assume that <span class="math inline">\(\mu_k = 0\)</span> for all <span class="math inline">\(k \geq 1\)</span>.<br>
So we want to prove that</p>
<p><span class="math display">\[
\frac{S_n}{V_n} \overset{d}{\rightarrow} Z,
\quad \text{as} \quad n \rightarrow \infty
\]</span></p>
<p>where <span class="math inline">\(Z \sim \mathcal{N}(0,1)\)</span>.<br>
</p>
<p>For the proof we are going to use the <strong>Lévy’s Continuity Theorem</strong> (<a href="#thm-levy-cont" class="quarto-xref">Theorem&nbsp;3</a>), which establishes a relationship between convergence in distribution and convergence of characteristic functions.</p>
<div id="thm-levy-cont" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Lévy’s Continuity Theorem)</strong></span> Let <span class="math inline">\(\{X_n\}_{n \geq 1}\)</span> be a sequence of random variables. Then</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\qquad \varphi_{X_n}(t) \rightarrow \varphi_X(t)
\quad \text{as } n \rightarrow \infty
\quad \forall t \in \mathbb{R}, \\
&amp;\Leftrightarrow \quad
X_n \overset{d}{\rightarrow} X
\quad \text{as } n \rightarrow \infty.
\end{aligned}
\]</span></p>
</div>
<p>By proving that <span class="math inline">\(\varphi_{\frac{S_n}{V_n}}(t) \to \varphi_Z(t)\)</span> we can conclude that <span class="math inline">\(\frac{S_n}{V_n} \xrightarrow{d} Z\)</span> which is the result we want.</p>
<p>To show that <span class="math inline">\(\varphi_{\frac{S_n}{V_n}}(t)\)</span> converges pointwise to the characteristic function of the standard normal distribution <span class="math inline">\(\varphi_Z(t)\)</span>, we proceed as follows: We approximate <span class="math inline">\(\varphi_{\frac{S_n}{V_n}}(t)\)</span> using its Taylor expansion. This approximation leads to an expression that coincides with <span class="math inline">\(\varphi_Z(t)\)</span>, and we then show that the remainder (error) term tends to zero as <span class="math inline">\(n \to \infty\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Sketch of the proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Sketch of the proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\varphi_{\frac{S_n}{V_n}}(t) = \varphi_{S_n}\!\left( \frac{t}{V_n} \right)
\]</span></p>
<p><span class="math display">\[
\left( S_n = \sum_{k=1}^n X_k, \quad X_k \text{ indep.} \right)
\]</span></p>
<p><span class="math display">\[
= \prod_{k=1}^n \varphi_{X_k}\!\left( \frac{t}{V_n} \right)
= \left( \varphi = \exp(\log \varphi) \right)
\]</span></p>
<p><span class="math display">\[
= \exp\!\left\{ \sum_{k=1}^n \log \varphi_{X_k}\!\left( \frac{t}{V_n} \right) \right\}
\]</span></p>
<p><span class="math display">\[
\overset{(*)}{\approx}
\exp\!\left\{ -\sum_{k=1}^n \left( 1 - \varphi_{X_k}\!\left( \frac{t}{V_n} \right) \right) \right\}
\]</span></p>
<p><span class="math display">\[
\overset{(**)}{\approx}
\exp\!\left\{ -\sum_{k=1}^n
\left( 1 - \left( 1 + \frac{it}{V_n} \mathbb{E}X_k + \frac{(it)^2}{2V_n^2} \mathbb{E}X_k^2 \right) \right)
\right\}
\]</span></p>
<p><span class="math display">\[
= \exp\!\left\{ -\sum_{k=1}^n
\left( 1 - \left( 1 - \frac{t^2}{2V_n^2}\sigma_k^2 \right) \right)
\right\}
\]</span></p>
<p><span class="math display">\[
= \exp\!\left\{ -\frac{t^2}{2V_n^2} \sum_{k=1}^n \sigma_k^2 \right\}
= e^{-\frac{t^2}{2}}.
\]</span></p>
<p>Where <span class="math inline">\((*)\)</span> follows from the Taylor expansion of <span class="math inline">\(\log(1 + x)\)</span> around <span class="math inline">\(x = 0\)</span> and <span class="math inline">\((**)\)</span> follows from the Taylor expansion of <span class="math inline">\(\varphi_{X_k}(t)\)</span> around <span class="math inline">\(t = 0\)</span>. We need to prove that those <span class="math inline">\(\approx\)</span> are <span class="math inline">\(=\)</span> when <span class="math inline">\(n \to \infty\)</span>, i.e.&nbsp;the error terms vanish.</p>
</div>
</div>
</div>
<p>This combination of <strong>Lévy’s Continuity Theorem</strong> and <strong>Taylor series expansion</strong> can be used to prove different theorems, including the <strong>original Central Limit Theorem</strong>.</p>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<p>A cool application of Lindeberg-Feller theorem is in the area of Linear Regression. For those that are in a Regression course, or already take one, you will have seen that the Ordinary Least Squares (OLS) estimator follows a normal distribution when the errors are normal. But … <strong><em>what if the errors are not normal?</em></strong> Well, under certain assumptions we can use the Lindeberg-Lévy-Feller theorem to show that the OLS estimator assympotically follows a normal distribution. For simplicity we are going to prove it for the estimator of the slope coefficient in a simple linear regression model (SLR).</p>
<p><span id="eq-lin-reg"><span class="math display">\[
y_i = \beta_0 + \beta_1x_i + e_i, \quad e_i \quad i.i.d \quad \forall i = 1, \dots, n
\tag{5}\]</span></span></p>
<p>A simple linear regression model is given by <a href="#eq-lin-reg" class="quarto-xref">Equation&nbsp;5</a>, where <span class="math inline">\(\mathbb{E}[e_i] = 0\)</span> and <span class="math inline">\(\text{Var}(e_i) = \sigma^2\)</span>. We have that the estimator for the slope in SLR is given by</p>
<p><span id="eq-ols-beta1-def"><span class="math display">\[
\hat{\beta}_{1n} = \frac{\sum_{i=1}^n(y_i - \bar{Y}_ n)(x_i - \bar{X}_n)}{\sum_{i=1}^n(x_i - \bar{X}_n)^2}
\tag{6}\]</span></span></p>
<p>You can notice that in <a href="#eq-ols-beta1-def" class="quarto-xref">Equation&nbsp;6</a> we have a subindex <span class="math inline">\(n\)</span>, this is because <span class="math inline">\(\hat{\beta}_{1n}\)</span> (and the means <span class="math inline">\(\bar{X}_n\)</span>, <span class="math inline">\(\bar{Y}_n\)</span> too) changes with the sample size, and we want to study its asymptotic behavior when <span class="math inline">\(n \to \infty\)</span>.</p>
<p>After some math we can rewrite <span class="math inline">\(\hat{\beta}_{1n}\)</span> as a linear combination of the erros</p>
<p><span id="eq-ols-combination"><span class="math display">\[
\hat{\beta}_{1n} = \beta_1 + \frac{\sum_{i=1}^n(x_i - \bar{X}_n)e_i}{\sum_{i=1}^n(x_i - \bar{X}_n)^2}
\tag{7}\]</span></span></p>
<p>We can define the sequence of random variables</p>
<p><span class="math display">\[
W_{ni} := (x_i - \bar{X}_n)e_i
\]</span></p>
<p>And rewrite <a href="#eq-ols-combination" class="quarto-xref">Equation&nbsp;7</a> as</p>
<p><span class="math display">\[
\hat{\beta}_{1n} = \beta_1 + \frac{\sum_{i=1}^nW_{ni}}{\sum_{i=1}^n(x_i - \bar{X}_n)^2}
\]</span></p>
<p>We have that the expected value of <span class="math inline">\(W_{ni}\)</span> is zero and its variance is given by <span class="math inline">\(\sigma^2(x_i - \bar{X})^2\)</span>, since the only random part is <span class="math inline">\(e_i\)</span> and they are i.i.d, with mean zero and variance <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Our goal is to proof that <span id="eq-ols-convergence"><span class="math display">\[
\frac{\sum_{i=1}^{n}W_{ni}}{\sigma\sqrt(\sum_{i=1}^{n}(x_i - \bar{X}_n)^2)} \overset{d}{\rightarrow} \mathcal{N}(0,1), \quad \text{as} \quad n \rightarrow \infty
\tag{8}\]</span></span></p>
<p>Note that proving these we are proving <span class="math inline">\(\hat{\beta}_{1n} \overset{d}{\rightarrow} \mathcal{N}(\beta_1, \frac{\sigma^2}{\sum_{i=1}^n(x_i - \bar{X_i})^2})\)</span> since</p>
<p><span class="math display">\[\begin{align*}
\hat{\beta}_{1n} &amp;= \beta_1 + \frac{\sum_{i=1}^nW_{ni}}{\sum_{i=1}^n(x_i - \bar{X}_n)^2} \\
&amp;= \beta_1 + \frac{\sigma}{\sqrt{\sum_{i=1}^n(x_i - \bar{X}_n)^2}} \cdot \frac{\sum_{i=1}^{n}W_{ni}}{\sigma\sqrt(\sum_{i=1}^{n}(x_i - \bar{X})^2)}\\
&amp;\overset{d}{\rightarrow} \beta_1 + \frac{\sigma}{\sqrt{\sum_{i=1}^n(x_i - \bar{X}_n)^2}} \cdot Z = \mathcal{N}\left(\beta_1, \frac{\sigma^2}{\sum_{i=1}^n(x_i - \bar{X_i})^2}\right)
\end{align*}\]</span></p>
<p>Thanks to Lindeberg-Lévy-Feller theorem <a href="#thm-llf" class="quarto-xref">Theorem&nbsp;2</a>, we only need to prove that <span class="math inline">\(L_1\)</span> (<a href="#eq-Lind1" class="quarto-xref">Equation&nbsp;2</a>) holds for the sequence <span class="math inline">\(\{W_{ni}\}_{i=1}^{n}\)</span> to conclude that <a href="#eq-ols-convergence" class="quarto-xref">Equation&nbsp;8</a> holds.</p>
<p>In [ADD PROOF], we conclude that we can change the identical distribution requirement for</p>
<p><span class="math display">\[
\max_{1 \leq j \leq n} \frac{(x_j - \bar{X}_n)^2}{\sum_{i=1}^{n}(x_i - \bar{X}_n)^2} \underset{n \rightarrow \infty}{\rightarrow} 0
\]</span></p>
<p>That is a much relaxed requirement.</p>
<section id="example-simulation" class="level3">
<h3 class="anchored" data-anchor-id="example-simulation">Example Simulation</h3>
<p>To simulate this experiment, we generate data from the linear model <span class="math inline">\(y = 1 + 2x + \epsilon\)</span>, where the errors <span class="math inline">\(\epsilon\)</span> follow an exponential distribution with variance <span class="math inline">\(\sigma^{2} = 64\)</span>. Using Monte Carlo replication, we examine the sampling distribution of the OLS estimator for different sample sizes. As shown in the widget, increasing the sample size causes the sampling distribution to approach a normal distribution centered around the true value <span class="math inline">\(\beta_{1} = 2\)</span>.</p>
<div class="cell panel-input card bg-light p-2" width="100%">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="291" data-source-offset="-42"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 290;"><span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> aq<span class="op">.</span><span class="fu">loadCSV</span>(<span class="st">"https://raw.githubusercontent.com/brunotancredi/lindeberg-feller/refs/heads/main/ols_montecarlo_simulation.csv"</span>)</span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a>viewof z <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2</span><span class="op">,</span> <span class="dv">500</span>]<span class="op">,</span> </span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">value</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Sample Size:"</span>}</span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a>ols_data <span class="op">=</span> data<span class="op">.</span><span class="fu">filter</span>(aq<span class="op">.</span><span class="fu">escape</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">n</span> <span class="op">===</span> z))</span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a>binThresholds <span class="op">=</span> {</span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> nbins <span class="op">=</span> <span class="dv">30</span><span class="op">;</span> <span class="co">// &lt;- your desired number of bins</span></span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> [xmin<span class="op">,</span> xmax] <span class="op">=</span> d3<span class="op">.</span><span class="fu">extent</span>(ols_data<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">ols_estimator</span>)<span class="op">;</span></span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> step <span class="op">=</span> (xmax <span class="op">-</span> xmin) <span class="op">/</span> nbins<span class="op">;</span></span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a>  <span class="co">// nbins bins = nbins+1 edges</span></span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> d3<span class="op">.</span><span class="fu">range</span>(xmin<span class="op">,</span> xmax <span class="op">+</span> step <span class="op">*</span> <span class="fl">1.0001</span><span class="op">,</span> step)<span class="op">;</span></span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> ols_data<span class="op">.</span><span class="fu">numRows</span>()</span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb2-312"><a href="#cb2-312" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb2-313"><a href="#cb2-313" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {<span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb2-314"><a href="#cb2-314" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">round</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb2-315"><a href="#cb2-315" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb2-316"><a href="#cb2-316" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">rectY</span>(</span>
<span id="cb2-317"><a href="#cb2-317" aria-hidden="true" tabindex="-1"></a>      ols_data<span class="op">,</span></span>
<span id="cb2-318"><a href="#cb2-318" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">binX</span>(</span>
<span id="cb2-319"><a href="#cb2-319" aria-hidden="true" tabindex="-1"></a>        { <span class="dt">y</span><span class="op">:</span> <span class="st">"proportion"</span> }<span class="op">,</span></span>
<span id="cb2-320"><a href="#cb2-320" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-321"><a href="#cb2-321" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> <span class="st">"ols_estimator"</span><span class="op">,</span></span>
<span id="cb2-322"><a href="#cb2-322" aria-hidden="true" tabindex="-1"></a>          <span class="dt">thresholds</span><span class="op">:</span> binThresholds<span class="op">,</span>   <span class="co">// fixed # of bins</span></span>
<span id="cb2-323"><a href="#cb2-323" aria-hidden="true" tabindex="-1"></a>          <span class="dt">inset</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb2-324"><a href="#cb2-324" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])</span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-6" data-nodetype="expression">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="lyapounovs-condition" class="level2">
<h2 class="anchored" data-anchor-id="lyapounovs-condition">Lyapounov’s Condition</h2>
<p>Sometimes proving the Lindeberg’s condition (<a href="#eq-Lind1" class="quarto-xref">Equation&nbsp;2</a>) can be difficult, so we can use an alternative condition known as Lyapounov’s condition. So we can start by checking if <span class="math inline">\(L_y\)</span> is true and if it fails, we can try to prove that <span class="math inline">\(L_1\)</span> is true.</p>
<p>Let <span class="math inline">\(\{X_n\}_{n \geq 1}\)</span> a sequence of random variables given as before and assume, in addition, that <span class="math inline">\(\mathbb{E}[|X_k - \mu_k|^{2+\delta}] &lt; \infty\)</span> for all <span class="math inline">\(k\)</span> and some <span class="math inline">\(\delta &gt; 0\)</span>. The advantage of</p>
<p><span id="eq-lyapunov"><span class="math display">\[
L_y(n, r) = \frac{1}{V_n^{2+\delta}}\sum^{n}_{k=1}\mathbb{E}|X_k - \mu_k|^{2+\delta} \rightarrow 0 \quad \text{as} \quad n \rightarrow \infty
\tag{9}\]</span></span></p>
<p><span class="math display">\[
\Rightarrow \frac{1}{V_n}\sum^n_{k=1}(X_k - \mu_k) \overset{d}{\rightarrow} \mathcal{N}(0,1) \quad \text{as} \quad n \rightarrow \infty
\]</span></p>
<p>For proving this condition we can show that when the Lyapunov’s condition (<a href="#eq-lyapunov" class="quarto-xref">Equation&nbsp;9</a>) is satisfied so is the Lindeberg’s condition (<a href="#eq-Lind1" class="quarto-xref">Equation&nbsp;2</a>); i.e <span class="math inline">\(L_y \Rightarrow L_1\)</span>.</p>
<p>It’s worth noticing that if, <span class="math inline">\(L_1\)</span> holds doesn’t implies that <span class="math inline">\(L_y\)</span> holds too.</p>
</section>
<section id="comments-when-it-fails" class="level2">
<h2 class="anchored" data-anchor-id="comments-when-it-fails">Comments: When it fails?</h2>
<p>The advantage of the Lindeberg–Lévy–Feller theorem is that it relaxes the strong assumption of identical distribution required in the classical Central Limit Theorem, replacing it with the more general Lindeberg condition. It is important to note that independence among random variables is still required. Moreover, as discussed earlier, the Lindeberg condition essentially limits the presence of heavy-tailed distributions. However, as shown by <span class="citation" data-cites="Newman2004">(<a href="#ref-Newman2004" role="doc-biblioref">Newman, 2004</a>)</span>, we can find heavy-tailed behavior everywhere. In his article, Newman lists several examples, including city populations, individual wealth, citations of scientific papers, website traffic, and others.</p>
<p>As an illustration, consider the empirical example using the dataset <span class="citation" data-cites="ache2022citationnetwork">(<a href="#ref-ache2022citationnetwork" role="doc-biblioref">Ache, 2022</a>)</span>, which contains 4,894,081 scientific papers and their corresponding citation counts.</p>
<p>As we can see in <a href="#fig-distribution-means" class="quarto-xref">Figure&nbsp;2</a>, the sampling distribution of the sample means doesn’t seem to follow a normal distribution; a clear heavy tail is present even when we increase the sample size. The probability of seeing an observation farther than 5 standard deviations under a normal distribution is …, and farther than 10 is …, and we have a lot of them!</p>
<p>So we have two possibilities: either I ran the experiment infinitely many times, changing the seed until I got this crazy result, or the convergence to the normal distribution is simply not happening. I would ask you to believe my word that I didn’t mislead the experiment.</p>
<div id="fig-distribution-means" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distribution-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sampling_distribution_means.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distribution-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Centered sampling distributions of the sample means. Observations exceeding 5 standard deviations are highlighted in green, while those exceeding 10 standard deviations are highlighted in red.
</figcaption>
</figure>
</div>
<p>In <a href="#fig-lindeberg_convergence" class="quarto-xref">Figure&nbsp;3</a>, we can see how <span class="math inline">\(L_1\)</span> is not satisficied, since instead of converging to 0 it bounces, even with <span class="math inline">\(n=50000\)</span>.</p>
<div id="fig-lindeberg_convergence" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lindeberg_convergence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lindeberg_convergence.gif" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lindeberg_convergence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Evolution of the empirical Lindeberg condition for an arbitrary ε = 0.2
</figcaption>
</figure>
</div>
<p>As a final comment, here we are working with citations in papers that have a certain limitation (the most cited papers here have around 50,000 citations). Now think about views of a webpage: how many views does <a href="www.youtube.com">www.youtube.com</a> have compared to this humble page that talks about the Lindeberg–Lévy–Feller theorem? The variance there will be much higher, and this is just another example. So be careful, <strong>a heavy-tailed distribution might be waiting for you around the corner</strong>.</p>
</section>
<section id="comic-relief" class="level2">
<h2 class="anchored" data-anchor-id="comic-relief">Comic Relief</h2>
<blockquote class="blockquote">
<p>The Swedish mathematician Harald Cramér met Lindeberg in 1922. He later recalled this story about Lindeberg and the beautiful farm he owned. “When he was reproached for not being sufficiently active in his scientific work, he said <em>‘Well, I am really a farmer.’</em> And if somebody happened to say that his farm was not properly cultivated, his answer was <em>‘Of course my real job is to be a professor.’</em> …” <span class="citation" data-cites="lindeberg_wikipedia">(<a href="#ref-lindeberg_wikipedia" role="doc-biblioref">Wikipedia contributors, 2025</a>)</span></p>
</blockquote>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<hr>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-ache2022citationnetwork" class="csl-entry" role="listitem">
Ache, M. (2022). <em>Citation network dataset</em>. <a href="https://www.kaggle.com/datasets/mathurinache/citation-network-dataset" class="uri">https://www.kaggle.com/datasets/mathurinache/citation-network-dataset</a>.
</div>
<div id="ref-gut2013probability" class="csl-entry" role="listitem">
Gut, A. (2013). <em>Probability: A graduate course</em>. Springer New York. <a href="https://books.google.ca/books?id=9TmRgPg-6vgC">https://books.google.ca/books?id=9TmRgPg-6vgC</a>
</div>
<div id="ref-li_large_sample_theory_2020" class="csl-entry" role="listitem">
Li, J. J. (2020). <em>Large sample theory (fall 2020)</em>. YouTube playlist. <a href="https://www.youtube.com/playlist?list=PLAYxx7zX5F1NKukTVwMADi1D5dbufWJkz">https://www.youtube.com/playlist?list=PLAYxx7zX5F1NKukTVwMADi1D5dbufWJkz</a>
</div>
<div id="ref-Newman2004" class="csl-entry" role="listitem">
Newman, M. (2004). Power laws, pareto distributions and zipf’s law. <em>Contemporary Physics - CONTEMP PHYS</em>, <em>46</em>. <a href="https://doi.org/10.1080/00107510500052444">https://doi.org/10.1080/00107510500052444</a>
</div>
<div id="ref-Vaart_1998" class="csl-entry" role="listitem">
Vaart, A. W. van der. (1998). <em>Asymptotic statistics</em>. Cambridge University Press.
</div>
<div id="ref-lindeberg_wikipedia" class="csl-entry" role="listitem">
Wikipedia contributors. (2025). <em>Jarl waldemar lindeberg</em>. <a href="https://en.wikipedia.org/wiki/Jarl_Waldemar_Lindeberg" class="uri">https://en.wikipedia.org/wiki/Jarl_Waldemar_Lindeberg</a>.
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7IGFxLCBvcCB9IGZyb20gJ0B1d2RhdGEvYXJxdWVybydcblxubXlfZGF0YSA9IGFxLmxvYWRDU1YoXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYnJ1bm90YW5jcmVkaS9saW5kZWJlcmctZmVsbGVyL3JlZnMvaGVhZHMvbWFpbi9DTFRfc2ltdWxhdGlvbl9kYXRhLmNzdlwiKVxuXG52aWV3b2YgbiA9IElucHV0cy5yYW5nZShcbiAgWzEsIDQwMF0sIFxuICB7dmFsdWU6IDEsIHN0ZXA6IDEsIGxhYmVsOiBcIlNhbXBsZSBTaXplOlwifVxuKVxuXG52aWV3b2YgZGlzdHJpYnV0aW9uID0gSW5wdXRzLnJhZGlvKFtcIlVuaWZvcm1cIiwgXCJFeHBvbmVudGlhbFwiXSwge3ZhbHVlOiBcIlVuaWZvcm1cIiwgbGFiZWw6IFwiRGlzdHJpYnV0aW9uXCJ9KVxuXG5ub3JtYWxEYXRhID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogMTAwIH0sIChfLCBpKSA9PiB7XG4gIGxldCB4ID0gLTMgKyAoaSAvIDk5KSAqIDY7IC8vIFJhbmdlIGZyb20gLTMgdG8gM1xuICByZXR1cm4geyB4LCB5OiBNYXRoLmV4cCgtMC41ICogeCAqIHgpIC8gTWF0aC5zcXJ0KDIgKiBNYXRoLlBJKSB9O1xufSk7XG5cblxubXlfZGF0YV8yID0gbXlfZGF0YS5wYXJhbXMoeyBkaXN0cmlidXRpb24gfSkuZmlsdGVyKGQgPT4gZC5kaXN0cmlidXRpb24gPT09IGRpc3RyaWJ1dGlvbik7XG5cbnBvaW50ID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiAxfSwgKF8sIGkpID0+IHtyZXR1cm4ge3g6IDAsIHk6IDAuNX19KVxuXG5QbG90LnBsb3Qoe1xuICAgIHdpZHRoOiAxMDAwLFxuICAgIGhlaWdodDogNTAwLFxuICAgIHk6IHtncmlkOiB0cnVlfSxcbiAgICB4OiB7cm91bmQ6IHRydWV9LCAgICBcbiAgICBtYXJrczogW1xuICAgICAgUGxvdC5yZWN0WShteV9kYXRhXzIsIFxuICAgICAgICAgICAgICAgIFBsb3QuYmluWCh7eTogKGEsIGJpbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEubGVuZ3RoIC8gKDUwMDAqKGJpbi54MiAtIGJpbi54MSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgfX0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICB7eDoge3ZhbHVlOiBuLnRvU3RyaW5nKCksIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc2V0OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocmVzaG9sZHM6IGQzLnJhbmdlKC0zLDMgKyAwLjExLCAwLjExKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21haW46IFstMywgM10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX0pKSxcbiAgICAgIFBsb3QucnVsZVkoWzBdKSxcbiAgICAgIFBsb3QubGluZShub3JtYWxEYXRhLCB7IHg6IFwieFwiLCB5OiBcInlcIiwgc3Ryb2tlOiBcInJlZFwiIH0pLCAvL05vcm1hbFxuICAgICAgUGxvdC5kb3QocG9pbnQsIHt4OiBcInhcIiwgeTogXCJ5XCIsIHI6IDB9KSAgICBcbiAgICBdXG59KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG4vLyBMb2FkIGRhdGEgZ2VuZXJhdGVkIGJ5IE9MU19zaW11bGF0aW9uXG5kYXRhID0gYXEubG9hZENTVihcImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9icnVub3RhbmNyZWRpL2xpbmRlYmVyZy1mZWxsZXIvcmVmcy9oZWFkcy9tYWluL29sc19tb250ZWNhcmxvX3NpbXVsYXRpb24uY3N2XCIpXG5cbnZpZXdvZiB6ID0gSW5wdXRzLnJhbmdlKFxuICBbMiwgNTAwXSwgXG4gIHt2YWx1ZTogMiwgc3RlcDogMSwgbGFiZWw6IFwiU2FtcGxlIFNpemU6XCJ9XG4pXG5cbm9sc19kYXRhID0gZGF0YS5maWx0ZXIoYXEuZXNjYXBlKGQgPT4gZC5uID09PSB6KSlcblxuYmluVGhyZXNob2xkcyA9IHtcbiAgY29uc3QgbmJpbnMgPSAzMDsgLy8gPC0geW91ciBkZXNpcmVkIG51bWJlciBvZiBiaW5zXG4gIGNvbnN0IFt4bWluLCB4bWF4XSA9IGQzLmV4dGVudChvbHNfZGF0YSwgZCA9PiBkLm9sc19lc3RpbWF0b3IpO1xuICBjb25zdCBzdGVwID0gKHhtYXggLSB4bWluKSAvIG5iaW5zO1xuICAvLyBuYmlucyBiaW5zID0gbmJpbnMrMSBlZGdlc1xuICByZXR1cm4gZDMucmFuZ2UoeG1pbiwgeG1heCArIHN0ZXAgKiAxLjAwMDEsIHN0ZXApO1xufVxuXG5sZW5ndGggPSBvbHNfZGF0YS5udW1Sb3dzKClcblxuUGxvdC5wbG90KHtcbiAgd2lkdGg6IDEwMDAsXG4gIGhlaWdodDogNTAwLFxuICB5OiB7Z3JpZDogdHJ1ZX0sXG4gIHg6IHtyb3VuZDogdHJ1ZX0sXG4gIG1hcmtzOiBbXG4gICAgUGxvdC5yZWN0WShcbiAgICAgIG9sc19kYXRhLFxuICAgICAgUGxvdC5iaW5YKFxuICAgICAgICB7IHk6IFwicHJvcG9ydGlvblwiIH0sXG4gICAgICAgIHtcbiAgICAgICAgICB4OiBcIm9sc19lc3RpbWF0b3JcIixcbiAgICAgICAgICB0aHJlc2hvbGRzOiBiaW5UaHJlc2hvbGRzLCAgIC8vIGZpeGVkICMgb2YgYmluc1xuICAgICAgICAgIGluc2V0OiAwXG4gICAgICAgIH1cbiAgICAgIClcbiAgICApLFxuICAgIFBsb3QucnVsZVkoWzBdKVxuICBdXG59KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCduJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2Rpc3RyaWJ1dGlvbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCd6JykifV19
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>